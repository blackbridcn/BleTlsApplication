证书包含以下内容:

(1) Validity也即有效期，有效期包含生效时间和失效时间，是一个时间区间;
(2) 公钥信息Subject Public Key Info，包括公钥的加密算法和公钥内容；
(3) Fingerprints信息，fingerprints用于验证证书的完整性，也就是说确保证书没有被修改过。 其原理就是在发布证书时，发布者根据指纹算法(此处证书使用了SHA-1和SHA-256算法)计算整个证书的hash值(指纹)并和证书放在一起，client在打开证书时，自己也根据指纹算法计算一下证书的hash值(指纹)，如果和刚开始的值相同，则说明证书未被修改过；如果hash值不一致，则表明证书内容被篡改过；

(4) 证书的签名Certificate Signature Value和Certificate Signature Algorithm，对证书签名所使用的Hash算法和Hash值；

(5) 签发该证书的CA机构Issuer；

(6) 该证书是签发给哪个组织/公司信息Subject；

(7) 证书版本Version、证书序列号Serial Number以及Extensions扩展信息等。



Cipher Suite 一般是由四部分组成：

Key Exchange（Kx）:秘钥交换协商协议，主流有DH和ECDH算法,现在(据说斯诺登爆料后)基本上都改成DHE和ECDHE

Authentication（Au）:非对称认证算法，常见的算法有：DSA 、RSA、ECDSA（新兴趋势，性能和安全）

Encryption(Enc):对称加密算法，主流还是AES，

Message Authentication Code(MAC):消息认证算法（就是Hash算法），SHA256、SHA384（MD4和SHA1已结被王小云院士破解）


TLS协议分析
https://www.cnblogs.com/thammer/p/7654925.html



CipherSuite.TLS_ECDHE_ECDSA_WITH_AES_128_CCM,


ClientHello : TlsVersion ClientRandom CipherSuite Extensions(Elliptic Curves supported_groups)

ServerHello : TlsVersion（confirm） ServerRandom CipherSuite（confirm）


Server Certificate :Server Certificate

Server KeyExchange (ServerCertificate Encrypt):

Elliptic Curve Param（Curve Name ClientHello Extensions : Elliptic Curves）/
 PublicKey / Signature Hash Algorithm /Signature(对public 进行签名，)


Server Hello Done:


160303003F0200003B0303AFEF257E926623E006E5AC57D43AD36EDA812F16D244CA7FF18FB331C52AD4FE00C0AC0000130005000000170000FF01000100000B0002010016030302000B0001FC0001F90001F6308201F230820198A003020102020878B52D27EB134DAE301006072A8648CE3D020106052B8104000A306C311830160603550406130F6475616C69747920526F6F7420436131193017060355040B0C1048494420476C6F61626C205065616B65310E300C060355040A0C055065616B65310B300906035504061302434E310B300906035504080C024744310B300906035504070C02535A301E170D3232303130363133343833365A170D3233303130363133343833365A306D31193017060355040613106475616C6974792052656C617920436131193017060355040B0C1048494420476C6F61626C205065616B65310E300C060355040A0C055065616B65310B300906035504061302434E310B300906035504080C024744310B300906035504070C02535A3056301006072A8648CE3D020106052B8104000A03420004715E0AD6AF9E19F9BE400254E8AB781BDFCACA55385A331498CB444BA06816F0F4C68532F490A7491E23511C63206000C0C6270DD96C1B73EE282E4D5EAA11B4A320301E300C0603551D130101FF04023000300E0603551D0F0101FF040403020780300A06082A8648CE3D0403020348003045022054AC41613DE43730CEE2C376229223E4F64FC9E26913EA5C6ECB081E854027B2022100F897069682EFE8B3ED16E614406A955B944A833E33E5CD0661673C9E605E3D0516030300940C0000900300164104769BAC0E778992644230AF7B244C4037C07806E0C9C45206E543DD0757B2BD912E1477108C2B58BE3E7C452462836C41141A7C41FCD0BEB2F9316CF18CDDE9FF04030047304502207522936A907077A43ECC0A76241ACE869A9C3D80C583FDE2AB96F09FF9B411BA0221009472A792E429C450E79CCFCD17586070F121E7EA2901AF1A95C0C26C760D090716030300040E000000


